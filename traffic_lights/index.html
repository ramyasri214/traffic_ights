<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Traffic Light</title>
  <style>
    :root{
      --bg: #111;
      --housing: #222;
      --off: #2b2b2b;
      --size: 120px;
      --gap: 18px;
    }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: linear-gradient(180deg,#0a0a0a 0%, #111 100%);
      font-family:system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;
      color: #eee;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .panel {
      display:flex;
      flex-direction:column;
      gap: 24px;
      align-items:center;
    }

    .traffic {
      width: calc(var(--size) * 0.8);
      padding: 18px;
      border-radius: 20px;
      background: linear-gradient(180deg, var(--housing), #111);
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .lamp {
      width: var(--size);
      height: var(--size);
      background: var(--off);
      border-radius: 50%;
      margin: calc(var(--gap) / 2) 0;
      display:flex;
      align-items:center;
      justify-content:center;
      transition: box-shadow 300ms ease, background-color 300ms ease, transform 160ms ease;
      transform: translateY(0);
    }

    .lamp.on {
      transform: translateY(-2px);
      box-shadow: 0 16px 40px rgba(0,0,0,0.6),
                  0 0 40px 10px rgba(255,255,255,0.02) inset;
    }
    .lamp.red.on { background: linear-gradient(180deg,#ff3b3b,#c71818); box-shadow: 0 0 40px 8px rgba(255,59,59,0.35); }
    .lamp.yellow.on { background: linear-gradient(180deg,#ffd85f,#e5b800); box-shadow: 0 0 40px 8px rgba(255,216,95,0.32); }
    .lamp.green.on { background: linear-gradient(180deg,#4ce07a,#0aa84f); box-shadow: 0 0 40px 8px rgba(76,224,122,0.28); }

    /* Controls */
    .controls {
      margin-top:12px;
      display:flex;
      gap:8px;
      flex-direction:column;
      align-items:center;
    }
    .controls .row { display:flex; gap:8px; align-items:center; }
    button {
      background:#1e293b;
      color:#fff;
      border:0;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      box-shadow: 0 6px 16px rgba(2,6,23,0.6);
      font-weight:600;
    }
    button:active { transform: translateY(1px); }
    label { font-size:0.9rem; color:#cbd5e1; }
    input[type="range"] { width:140px; }

    /* small footnote */
    .status {
      margin-top:6px;
      font-size:0.95rem;
      color:#cbd5e1;
    }

    @media (max-width:480px){
      :root{ --size:84px; }
    }
  </style>
</head>
<body>
  <div class="panel" role="main">
    <div class="traffic" aria-label="Traffic light">
      <div id="red" class="lamp red" aria-live="polite" aria-checked="false" role="img" title="Red light"></div>
      <div id="yellow" class="lamp yellow" aria-live="polite" aria-checked="false" role="img" title="Yellow light"></div>
      <div id="green" class="lamp green" aria-live="polite" aria-checked="false" role="img" title="Green light"></div>
    </div>

    <div class="controls" aria-hidden="false">
      <div class="row">
        <button id="startBtn">Start</button>
        <button id="stopBtn" disabled>Stop</button>
        <button id="resetBtn">Reset</button>
      </div>

      <div class="row" style="align-items:center;">
        <label for="speed">Speed:</label>
        <input id="speed" type="range" min="400" max="3000" step="100" value="1000" />
        <span id="speedVal">1000ms</span>
      </div>

      <div class="status" id="statusText">Status: stopped</div>
    </div>
  </div>

  <script>
    // Elements
    const red = document.getElementById('red');
    const yellow = document.getElementById('yellow');
    const green = document.getElementById('green');

    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const resetBtn = document.getElementById('resetBtn');
    const speedInput = document.getElementById('speed');
    const speedVal = document.getElementById('speedVal');
    const statusText = document.getElementById('statusText');

    // State
    // Sequence: red -> green -> yellow -> red ...
    const sequence = ['red','green','yellow'];
    let currentIndex = 0;
    let timer = null;
    let interval = parseInt(speedInput.value, 10);

    function setLight(name) {
      // Turn all off first
      red.classList.remove('on'); red.setAttribute('aria-checked','false');
      yellow.classList.remove('on'); yellow.setAttribute('aria-checked','false');
      green.classList.remove('on'); green.setAttribute('aria-checked','false');

      // Turn the named light on
      if(name === 'red') {
        red.classList.add('on'); red.setAttribute('aria-checked','true');
      } else if(name === 'yellow') {
        yellow.classList.add('on'); yellow.setAttribute('aria-checked','true');
      } else if(name === 'green') {
        green.classList.add('on'); green.setAttribute('aria-checked','true');
      }

      statusText.textContent = 'Status: ' + name.toUpperCase();
    }

    function step() {
      const next = sequence[currentIndex % sequence.length];
      setLight(next);
      currentIndex++;
    }

    function start() {
      if(timer) return;
      interval = parseInt(speedInput.value,10);
      timer = setInterval(step, interval);
      startBtn.disabled = true;
      stopBtn.disabled = false;
      statusText.textContent = 'Running â€” ' + sequence[(currentIndex)%sequence.length].toUpperCase();
      // run immediately to show initial state
      step();
    }

    function stop() {
      if(!timer) return;
      clearInterval(timer);
      timer = null;
      startBtn.disabled = false;
      stopBtn.disabled = true;
      statusText.textContent = 'Stopped';
    }

    function reset() {
      stop();
      currentIndex = 0;
      setLight('red');
      statusText.textContent = 'Reset to RED';
    }

    // Speed control
    speedInput.addEventListener('input', () => {
      speedVal.textContent = speedInput.value + 'ms';
      // if running, restart interval with new speed
      if(timer) {
        clearInterval(timer);
        interval = parseInt(speedInput.value,10);
        timer = setInterval(step, interval);
      }
    });

    // Buttons
    startBtn.addEventListener('click', start);
    stopBtn.addEventListener('click', stop);
    resetBtn.addEventListener('click', reset);

    // Initialize to red
    setLight('red');

    // Keyboard shortcuts (optional)
    document.addEventListener('keydown', (e) => {
      if(e.key === 's') start();
      if(e.key === 'x') stop();
      if(e.key === 'r') reset();
    });
  </script>
</body>
</html>
